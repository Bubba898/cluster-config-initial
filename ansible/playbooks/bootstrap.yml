---
# Main bootstrap playbook - orchestrates the complete k3s + Flux setup
# This playbook imports individual playbooks in the correct order

- name: Prepare nodes
  ansible.builtin.import_playbook: ../includes/prepare-nodes.yml

- name: Install k3s
  ansible.builtin.import_playbook: ../includes/install-k3s.yml

- name: Setup kubeconfig
  ansible.builtin.import_playbook: ../includes/setup-kubeconfig.yml

- name: Setup Flux
  ansible.builtin.import_playbook: ../includes/setup-flux.yml

- name: Setup GitLab secrets
  ansible.builtin.import_playbook: ../includes/setup-gitlab-secrets.yml

- name: Migrate to in-cluster GitLab
  ansible.builtin.import_playbook: migrate-to-incluster-gitlab.yml

- name: Setup Headlamp authentication
  ansible.builtin.import_playbook: ../includes/setup-headlamp-auth.yml

- name: Display cluster summary
  ansible.builtin.import_playbook: display-cluster-summary.yml
